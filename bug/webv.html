<!DOCTYPE html>
<!-- upto 2 directory depth-->
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bug Report</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin"/>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;700;800&amp;display=swap"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;700;800&amp;display=swap" media="print" onload="this.media='all'"/>
    <noscript>
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;700;800&amp;display=swap"/>
    </noscript>
    <link href="../css/font-awesome/css/all.min.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/bootstrap-icons/bootstrap-icons.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/bootstrap.min.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/aos.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/main.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/code-con.css" rel="stylesheet">
    <noscript>
      <style type="text/css">
        [data-aos] {
            opacity: 1 !important;
            transform: translate(0) scale(1) !important;
        }
      </style>
    </noscript>
    
  </head>
  <body id="top">
    <header class="bg-light">
      <nav class="navbar navbar-expand-lg navbar-light bg-light" id="header-nav" role="navigation">
        <div class="container"><a class="link-dark navbar-brand site-title mb-0" href="#">Bug Reports</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto me-2">
              <li class="nav-item"><a class="nav-link" href="../#about">About</a></li>
              <li class="nav-item"><a class="nav-link" href="../bugbounty.html#">Bug Hunting</a></li>
              <li class="nav-item"><a class="nav-link" href="../blogs.html">Blogs</a></li> 
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <div class="page-content">
      <div id="content">
<header>

</header>






<div class="section px-3 px-lg-4 pt-5" id="webbug">
  <div class="container-narrow">
    <div class="text-center mb-5">
      <h2 class="marker marker-center">WebView</h2>
    </div>
    <div class="row">
      <div >
        <div class="card mb-3" data-aos="fade-right" data-aos-delay="100">
          <div class="card-header px-3 py-2">
            <div class="d-flex justify-content-center">
              <div >
                <h3 class="h5  mb-1">Webview Activity Exploit  &nbsp;</h3>
                <small>Date: 09/11/23</small>
              </div><img src="../images/services/webpage.svg" width="48" height="45" alt="ui-ux"/>
            </div>
          </div>
          <div class="card-body px-3 py-2">
           <p>
            A WebView activity is a component in mobile development that embeds a web browser within the application. It allows developers to display web content seamlessly without launching an external browser. WebView activities are commonly used to integrate web-based features into native mobile apps, enabling the incorporation of dynamic web content, online forms, and interactive elements. This approach provides a smoother user experience by combining the functionalities of native and web applications. While WebView activities enhance app versatility, developers must implement robust security measures to mitigate potential vulnerabilities associated with web content rendering within the app.    
        </p>

        <p>I downloaded an educational APK from the Play Store, I utilized JADX GUI to decompile the APK. Upon inspecting the AndroidManifest.xml file, I discovered that the WebViewActivity was marked as exported=true. This marks the first checkbox for potential exploitation, as to exploit any activity in an Android APK, it must be exported="true". This finding raises security concerns, emphasizing the importance of reviewing and securing exported activities to prevent unauthorized access and potential exploitation.</p>
        <img src="bug-images/webv.PNG" width="750" height="110">   
        <p><br>Following that, I opened the WebViewActivity to review its code and functionality. This step is crucial in understanding the implementation details and potential security vulnerabilities that may exist within the WebViewActivity. </p>
        <p>Upon reviewing the code of the WebView activity, I identified potential vulnerabilities, specifically an open redirect and a risk of Cross-Site Scripting (XSS) exploitation, given that JavaScript was enabled. An open redirect vulnerability could allow malicious redirection to external sites, posing a security risk. Additionally, the presence of JavaScript without proper input validation might expose the application to XSS attacks, leading to unauthorized script execution.</p>
        
        <img src="bug-images/webv2.PNG" width="750" height="310">  
        <p><br>Given that the intent is searching for a "url" parameter, the payload must be passed using the key "url." </p> 

        <div class="code-container" id="code1">
            <div class="code-header">
                <span>Code 1</span>
                <button class="copy-button" onclick="copyCode('code1')">Copy</button>
            </div>
            <div class="code-content">
                <pre>
    <code>
#ADB Command for Open redirect
>adb shell am start -n com.package.name/name.activ.core.activity.CounsellingWebViewActivity --es url "https://evil.com"

#ADB Command for XXS
adb shell am start -n com.package.name/name.activ.core.activity.CounsellingWebViewActivity --es url "javascript:alert\(2023\)"
    </code>
                </pre>
            </div>
        </div>
        <p>Hence, I executed an ADB command using the key "url" and the value "url and javascript" to validate the existence of the bug.</p>
        <img src="bug-images/webv3.PNG" width="550" height="700">  <br><br>
        <img src="bug-images/webv4.PNG" width="550" height="700">  


           
           
           
            </div>
        </div>
      </div>
      
      
     
     
      
    </div>
  </div>
</div>


</div>
    </div>
    <div id="scrolltop"><a class="btn btn-secondary" href="#top"><span class="icon"><i class="fas fa-angle-up fa-x"></i></span></a></div>
    <script src="../scripts/imagesloaded.pkgd.min.js?ver=1.2.0"></script>
    <script src="../scripts/masonry.pkgd.min.js?ver=1.2.0"></script>
    <script src="../scripts/BigPicture.min.js?ver=1.2.0"></script>
    <script src="../scripts/purecounter.min.js?ver=1.2.0"></script>
    <script src="../scripts/bootstrap.bundle.min.js?ver=1.2.0"></script>
    <script src="../scripts/aos.min.js?ver=1.2.0"></script>
    <script src="../scripts/main.js?ver=1.2.0"></script>
    <script>
        function copyCode(codeId) {
            var codeContainer = document.getElementById(codeId).querySelector('.code-content');
            var range = document.createRange();
            range.selectNode(codeContainer);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();

            var copyButton = document.querySelector('.copy-button');
            copyButton.classList.add('copied');

            setTimeout(function() {
                copyButton.classList.remove('copied');
            }, 500);
        }
    </script>
  </body>
</html>